---
import { Image } from 'astro:assets';
import Logo from '../assets/concilium-logo.svg';

const navItems = [
  { label: 'The Problem', href: '#the-problem' },
  { label: 'How It Works', href: '#how-it-works' },
  { label: 'Demo', href: '#demo' },
  { label: 'Source', href: 'https://github.com/matiasdaloia/concilium' },
  { label: 'Get Started', href: '#get-started', primary: true },
];
---

<nav class="fixed top-0 left-0 right-0 z-50 bg-bg-page/80 backdrop-blur-md border-b border-white/5">
  <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity group">
      <div class="w-8 h-8 flex items-center justify-center bg-white/5 rounded border border-white/10 group-hover:border-green-primary/50 transition-colors">
        <Image src={Logo} alt="Concilium" class="w-5 h-5 opacity-90" />
      </div>
      <span class="text-sm font-bold tracking-widest text-text-primary uppercase font-mono group-hover:text-green-primary transition-colors">Concilium</span>
    </a>

    <!-- Desktop nav -->
    <div class="hidden md:flex items-center gap-8">
      {navItems.map((item) => (
        <a
          href={item.href}
          class={`text-[10px] font-mono font-medium tracking-widest uppercase transition-all duration-300 relative group
            ${item.primary 
              ? 'px-4 py-2 bg-green-primary text-black font-bold hover:bg-green-400 rounded hover:shadow-[0_0_15px_rgba(34,197,94,0.4)]' 
              : 'text-text-secondary hover:text-green-primary'
            }`}
          target={item.href.startsWith('http') ? '_blank' : undefined}
          rel={item.href.startsWith('http') ? 'noopener noreferrer' : undefined}
        >
          {item.label}
          {!item.primary && (
            <span class="absolute -bottom-1 left-0 w-0 h-[1px] bg-green-primary group-hover:w-full transition-all duration-300"></span>
          )}
        </a>
      ))}
    </div>

    <!-- Mobile menu button -->
    <button
      class="md:hidden text-text-secondary hover:text-green-primary transition-colors p-2"
      aria-label="Toggle menu"
      id="mobile-menu-btn"
    >
      <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
      </svg>
    </button>
  </div>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="hidden md:hidden border-t border-white/5 bg-bg-page/95 backdrop-blur-xl absolute w-full left-0 top-16 shadow-2xl">
    <div class="px-6 py-6 flex flex-col gap-6">
      {navItems.map((item) => (
        <a
          href={item.href}
          class={`text-xs font-mono tracking-widest uppercase transition-colors flex items-center gap-2
            ${item.primary ? 'text-green-primary font-bold' : 'text-text-secondary hover:text-white'}`}
          target={item.href.startsWith('http') ? '_blank' : undefined}
          rel={item.href.startsWith('http') ? 'noopener noreferrer' : undefined}
        >
          {item.primary && <span class="w-1.5 h-1.5 bg-green-primary rounded-full animate-pulse"></span>}
          {item.label}
        </a>
      ))}
    </div>
  </div>
</nav>

<script>
  const btn = document.getElementById('mobile-menu-btn');
  const menu = document.getElementById('mobile-menu');

  btn?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
  });

  // Close menu when clicking a link
  menu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      menu.classList.add('hidden');
    });
  });
</script>
